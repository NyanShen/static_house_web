<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>我要提问</title>
    <meta name="keywords" content="我要提问">
    <meta name="description" content="我要提问">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" type="text/css" href="//static.fczx.com/www/css/_common.css">
    <link rel="stylesheet" type="text/css" href="//static.fczx.com/www/css/_module.css">
    <link rel="stylesheet" type="text/css" href="//static.fczx.com/www/css/qa/index.css">

    <script type="text/javascript" src="//static.fczx.com/www/js/lib/jquery.min.js"></script>
    <script type="text/javascript" src="//static.fczx.com/www/js/common/app.js"></script>
    <script type="text/javascript" src="//static.fczx.com/www/js/common/index.js"></script>
    <script type="text/javascript" src="//static.fczx.com/www/js/common/msg-modal.js"></script>
</head>

<body>
    <!--头部导航栏start-->
    <div class="main-nav">
        <div class="nav-content clearfix">
            <div class="nav-left fl clearfix">
                <div class="nav-item">
                    <a href="/" class="nav-logo">房产在线<small>Fczx.com</small></a>
                </div>
                <div class="nav-item nav-city">
                    <a href="javascript:void(0);" class="city-name">襄阳</a>
                </div>
                <div class="nav-item">
                    <ul class="nav-list">
                        <li><a href="/">首页</a></li>
                        <li><a href="/pages/building/list.html" target="_blank">新房</a></li>
                        <li><a>二手房</a></li>
                        <li><a>租房</a></li>
                        <li><a href="/pages/consult" target="_blank">资讯</a></li>
                        <li><a href="/pages/knowledge" target="_blank">知识</a></li>
                        <li><a href="/pages/qa" target="_blank">问答</a></li>
                    </ul>
                </div>
            </div>
            <div class="nav-right fr">
                <div class="nav-item login-link hide" id="loginLink">
                    <ul>
                        <li>
                            <a href="/pages/login" class="login-btn">登录</a>
                        </li>
                        <li>
                            <a href="/pages/login/register.html" class="login-btn">注册</a>
                        </li>
                    </ul>
                </div>
                <div class="login-user" id="loginUser">
                    <div class="nav-item">
                        <a href="/pages/user/index.html" class="login-btn">Nyan</a>
                    </div>
                    <div class="user-center">
                        <span class="triangle-up"></span>
                        <a href="">我的消息</a>
                        <a href="">我的回答</a>
                        <a href="">看房记录</a>
                        <a href="" class="logout">退出</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--头部导航栏end-->

    <!--面包屑及查询start-->
    <div class="qa-wrap">
        <div class="box-content">
            <div class="box-search clearfix">
                <!-- 面包屑start -->
                <div class="breadcrumb fl">
                    <span>当前位置： </span>
                    <a href="javascript:void(0);">房产在线<a>
                            <span>></span>
                            <a href="javascript:void(0);">问答</a>
                            <span>></span>
                            <a href="javascript:void(0);">我要提问</a>
                </div>
                <!-- 面包屑end -->
                <div class="search-content clearfix fr">
                    <form action="" class="search-form clearfix fl">
                        <input type="text" class="search-input" placeholder="请输入您的问题">
                        <input type="submit" class="search-btn" value="搜索">
                    </form>
                    <a href="/pages/qa/ask.html" class="search-primary-btn fr">我要提问</a>
                </div>
            </div>
        </div>
    </div>
    <!--面包屑及查询end-->

    <!-- 我要提问end -->
    <div class="box-content mt20">
        <!-- 问题导航start -->
        <div class="qa-wrap qa-nav clearfix">
            <div class="nav-item">
                <a class="item-a" href="/pages/qa/index.html">问题首页</a>
            </div>
            <div class="nav-item">
                <a class="item-a" href="/pages/qa/list.html">问答分类</a>
            </div>
            <div class="nav-item">
                <a class="item-a actived" href="/pages/qa/ask.html">我要提问</a>
            </div>
        </div>
        <!-- 问题导航end -->

        <div class="qa-wrap qa-ask mt20 clearfix">
            <div class="qa-ask-left fl">
                <div class="qa-ask-form">
                    <label for="askArea">请选择问题分类：</label>
                    <div class="clearfix">
                        <div class="select-item">
                            <div class="select-content">
                                <div class="select-text">
                                    <span>问题分类</span>
                                    <input type="hidden" name="qaAsk0" id="askId_0" value="">
                                    <i class="iconfont">&#xe68a;</i>
                                </div>
                                <ul class="select-list">
                                    <li data-value="101">买房</li>
                                    <li data-value="201">租房</li>
                                    <li data-value="301">贷款</li>
                                </ul>
                            </div>
                        </div>
                        <div class="select-item hide" id="subSelector">
                            <div class="select-content">
                                <div class="select-text">
                                    <span></span>
                                    <input type="hidden" name="qaAsk1" id="askId_1" value="">
                                    <i class="iconfont">&#xe68a;</i>
                                </div>
                                <ul class="select-list"></ul>
                            </div>
                        </div>
                    </div>
                    <label for="askArea">请描述您的问题：</label>
                    <textarea name="" id="askArea" cols="30" rows="10" placeholder="尽可能简短地描述您的问题，以便得到更专业的回答！"
                        maxlength="150"></textarea>
                    <p class="text-count">
                        <span class="count">0</span>/150字
                        <span class="limit"></span>
                    </p>
                    <a href="javascript:;" class="action-btn" id="askBtn">提交问题</a>
                </div>
            </div>
            <div class="qa-ask-right fr">
                <div class="qa-ask-title">
                    如何能获得快速准确的回答？
                </div>
                <div class="qa-ask-desc">
                    <p>1. 选择准确的分类</p>
                    <p>2. 问题内容描述准确</p>
                    <p>3. 如果是楼盘相关的问题，请输入正确的楼盘名称</p>
                </div>
            </div>
        </div>
    </div>
    <!-- 我要提问end -->

    <!--底部footer start-->
    <div class="box-content">
        <div class="box-footer">
            <p class="copyright">Copyright © 2020 Fang.com Corporation, All Rights Reserved</p>
            <p class="contact">客服热线：0632-5677111（工作时间：周一至周六8:00-17:00）</p>
            <p class="record">
                工信部备案/许可证编号：
                <a href="javascript:void(0);">鲁ICP备14025533-3号</a>
                <a href="javascript:void(0);">鲁公网安备37048102006002号</a>
            </p>
        </div>
    </div>
    <!--底部footer end-->

</body>

<script type="text/javascript">
    $(document).ready(function () {
        let askList = [
            {
                id: '101',
                name: '买房',
                children: [
                    {
                        id: '111',
                        fatherId: '101',
                        name: '买房准备'
                    },
                    {
                        id: '112',
                        fatherId: '101',
                        name: '看房选房'
                    }
                ]
            },
            {
                id: '201',
                name: '租房',
                children: [
                    {
                        id: '211',
                        fatherId: '201',
                        name: '租房准备'
                    },
                    {
                        id: '212',
                        fatherId: '201',
                        name: '租房注意事项'
                    }
                ]
            },
            {
                id: '301',
                name: '贷款',
                children: [
                    {
                        id: '311',
                        fatherId: '301',
                        name: '贷款条件'
                    }
                ]
            }
        ];
        $('.select-item .select-content').each(function () {
            $(this).hover(function () {
                $(this).find('.select-list').show();
            }, function () {
                $(this).find('.select-list').hide();
            })
        });

        $('.select-item .select-list li').each(function () {
            $(this).click(function () {
                let text = $(this).text();
                let value = $(this).attr('data-value');
                let targetText = $(this).parents('.select-content');
                targetText.find('span').text(text);
                targetText.find('input').attr('value', value);
                $(this).parents('.select-list').hide();
                $('#subSelector').show();
                let childrenData = find(askList, value);
                if (childrenData && childrenData.length > 0) {
                    let firstItem = childrenData[0];
                    $('#subSelector').find('span').text(firstItem.name);
                    $('#subSelector').find('input').val(firstItem.id);
                    let _html = '';
                    for (const item of childrenData) {
                        _html = _html + `<li data-value="${item.id}">${item.name}</li>`;
                    }
                    $('#subSelector').find('.select-list').html(_html);
                    initSelector();
                }
            });
        });

        function initSelector() {
            $('#subSelector .select-list li').each(function () {
                $(this).click(function () {
                    let text = $(this).text();
                    let value = $(this).attr('data-value');
                    let targetText = $(this).parents('.select-content');
                    targetText.find('span').text(text);
                    targetText.find('input').attr('value', value);
                    $(this).parents('.select-list').hide();
                });
            });
        }

        function find(list, value) {
            for (const item of list) {
                if (item.id == value) {
                    return item.children
                }
            }
        }

        // 输入问题内容并提交
        let askArea = $('#askArea');
        inputListener(askArea, 500);

        $('#askBtn').click(function() {
            let askId = $('#askId_1').val();
            if (!askId) {
                alert('请您选择问题分类，以更好获取答案');
                return;
            }
            
            let textnum = askArea.val().replace(/\s+/g, "").length;
            if (textnum <= 0) {
                alert('问题内容不能为空');
                return;
            }
            app.request({
                url: app.areaApiUrl('/test/test'),
                data: {
                    askId,
                    content: askArea.val()
                },
                type: 'POST',
                dataType: 'json',
                headers: {},
                done: function () {
                    $.MsgModal.Success('点评成功', '关闭弹窗返回评论列表查看评论', function () {
                        window.location.href = "/pages/building/comment.html";
                    });
                }
            });
        });
    });
</script>

</html>